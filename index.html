<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>早得クーポン（仮LIFF）</title>
  <meta name="description" content="早く使うほど割引率がお得な「早得クーポン」仮ページ" />

  <style>
    :root{
      --line-green:#06c755;
      --bg:#f2f3f5;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --border:#e5e7eb;
      --shadow:0 10px 25px rgba(0,0,0,.08);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", "Meiryo", sans-serif;
      background: var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }
    a{color:inherit}
    .app{
      max-width: 460px;
      margin: 0 auto;
      min-height: 100dvh;
      padding-bottom: 24px;
    }

    /* LINEっぽいヘッダー */
    .topbar{
      position: sticky;
      top: 0;
      z-index: 10;
      background: var(--line-green);
      color: #fff;
      padding: 14px 16px 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,.12);
    }
    .topbar .row{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      background: rgba(255,255,255,.16);
      border: 1px solid rgba(255,255,255,.22);
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      letter-spacing: .2px;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;background:#fff;
      box-shadow: 0 0 0 3px rgba(255,255,255,.18);
    }
    .title{
      margin: 10px 0 0;
      font-size: 20px;
      line-height: 1.25;
      font-weight: 800;
      letter-spacing: .2px;
    }
    .subtitle{
      margin: 6px 0 0;
      font-size: 13px;
      opacity: .92;
      line-height: 1.5;
    }

    /* カード */
    .card{
      margin: 14px 12px 0;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card-h{
      padding: 14px 14px 10px;
      border-bottom: 1px solid var(--border);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
    }
    .card-h h2{
      margin:0;
      font-size: 16px;
      font-weight: 800;
      line-height: 1.3;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      border: 1px solid var(--border);
      background:#f9fafb;
      color: var(--muted);
      white-space:nowrap;
    }
    .card-b{ padding: 14px; }

    /* 進捗ゲージ */
    .meter{
      margin-top: 8px;
      background: #eef2ff;
      border: 1px solid #e0e7ff;
      border-radius: 999px;
      height: 12px;
      overflow:hidden;
    }
    .meter > div{
      height:100%;
      width: 0%;
      background: linear-gradient(90deg, #22c55e, #06c755);
      border-radius: 999px;
      transition: width .6s ease;
    }
    .small{
      margin-top: 10px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.6;
    }

    /* クーポン枠 */
    .coupon{
      margin-top: 12px;
      border: 1px dashed #c7f9d7;
      background: #f0fff6;
      border-radius: 16px;
      padding: 14px;
    }
    .coupon .big{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:12px;
    }
    .off{
      font-size: 34px;
      font-weight: 900;
      letter-spacing: .3px;
      color: #0f172a;
    }
    .off span{
      font-size: 14px;
      font-weight: 800;
      margin-left: 2px;
      color: #0f172a;
    }
    .deadline{
      text-align:right;
      font-size: 12px;
      color: #065f46;
      font-weight: 700;
    }
    .rules{
      margin: 10px 0 0;
      padding-left: 18px;
      color: #14532d;
      font-size: 12px;
      line-height: 1.65;
    }

    /* 割引テーブル */
    .steps{
      margin-top: 14px;
      display:grid;
      gap:10px;
    }
    .step{
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      background:#fff;
    }
    .step .left{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }
    .tag{
      width: 34px;
      height: 34px;
      border-radius: 10px;
      display:grid;
      place-items:center;
      font-weight:900;
      color:#fff;
      background: #9ca3af;
      flex: 0 0 auto;
    }
    .step.active{
      border-color: #86efac;
      box-shadow: 0 10px 22px rgba(6,199,85,.18);
    }
    .step.active .tag{ background: var(--line-green); }
    .when{
      font-weight: 800;
      font-size: 13px;
      line-height: 1.25;
      white-space:nowrap;
    }
    .desc{
      font-size: 12px;
      color: var(--muted);
      line-height: 1.35;
      overflow:hidden;
      text-overflow: ellipsis;
      white-space:nowrap;
      max-width: 240px;
    }
    .rate{
      font-weight: 900;
      font-size: 16px;
      color: #111827;
      white-space:nowrap;
    }

    /* ボタン */
    .actions{
      display:grid;
      gap:10px;
      margin-top: 14px;
    }
    .btn{
      border: 0;
      border-radius: 14px;
      padding: 14px 14px;
      font-size: 15px;
      font-weight: 900;
      cursor: pointer;
    }
    .btn.primary{
      background: var(--line-green);
      color: #fff;
      box-shadow: 0 12px 28px rgba(6,199,85,.25);
    }
    .btn.ghost{
      background:#fff;
      border: 1px solid var(--border);
      color: #111827;
    }
    .btn:active{ transform: translateY(1px); }

    /* フッター */
    .foot{
      margin: 14px 12px 0;
      color: var(--muted);
      font-size: 11px;
      line-height: 1.6;
      text-align:center;
    }
    .chip{
      display:inline-block;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background:#fff;
      margin: 0 3px;
    }
  </style>
</head>

<body>
  <div class="app">
    <header class="topbar">
      <div class="row">
        <span class="badge"><span class="dot"></span> 仮LIFF / GitHub Pages</span>
      </div>
      <h1 class="title">早得クーポン</h1>
      <p class="subtitle">「早く使うほど割引率がお得」— 期限が近づくほど割引は小さくなります。</p>
    </header>

    <section class="card" aria-label="クーポン概要">
      <div class="card-h">
        <h2>今日の早得</h2>
        <span class="pill" id="statusPill">判定中…</span>
      </div>

      <div class="card-b">
        <div class="coupon">
          <div class="big">
            <div class="off" id="offText">--<span>% OFF</span></div>
            <div class="deadline">
              有効期限<br>
              <span id="deadlineText">--</span>
            </div>
          </div>
          <ul class="rules">
            <li>店頭で「この画面」を提示（サンプル）</li>
            <li>1会計1回まで（サンプル）</li>
            <li>他クーポン併用不可（サンプル）</li>
          </ul>
        </div>

        <div class="small">
          いまの時間に応じて「本日の割引」を自動で切り替えるサンプルです。<br>
          ※ 本番では「配布日」や「利用回数」なども判定できます。
        </div>

        <div class="meter" aria-label="時間経過ゲージ">
          <div id="meterBar"></div>
        </div>

        <div class="steps" aria-label="割引ステップ">
          <div class="step" id="s1">
            <div class="left">
              <div class="tag">A</div>
              <div>
                <div class="when">朝の早得</div>
                <div class="desc">早起き特典（例：〜10:59）</div>
              </div>
            </div>
            <div class="rate">30% OFF</div>
          </div>

          <div class="step" id="s2">
            <div class="left">
              <div class="tag">B</div>
              <div>
                <div class="when">昼の早得</div>
                <div class="desc">お昼前後（例：11:00〜16:59）</div>
              </div>
            </div>
            <div class="rate">20% OFF</div>
          </div>

          <div class="step" id="s3">
            <div class="left">
              <div class="tag">C</div>
              <div>
                <div class="when">夕方の早得</div>
                <div class="desc">夕方以降（例：17:00〜）</div>
              </div>
            </div>
            <div class="rate">10% OFF</div>
          </div>
        </div>

        <div class="actions" aria-label="アクション">
          <button class="btn primary" id="useBtn">このクーポンを使う（サンプル）</button>
          <button class="btn ghost" id="shareBtn">友だちに共有（サンプル）</button>
        </div>
      </div>
    </section>

    <div class="foot">
      <span class="chip">HAYA-TOKU</span>
      <span class="chip">LIFF検証用</span>
      <span class="chip" id="nowText">--</span><br>
      ※ これはデザイン見本です。LIFFの処理（liff.init等）は次で足せます。
    </div>
  </div>

  <script>
    // --- 早得ロジック（サンプル） ---
    // 例：朝30% / 昼20% / 夕10%
    // 必要なら「日付ベース」「経過時間ベース」「在庫・残枚数ベース」などに拡張できます。

    function pad2(n){ return String(n).padStart(2,'0'); }

    function formatJP(d){
      return `${d.getFullYear()}-${pad2(d.getMonth()+1)}-${pad2(d.getDate())} ${pad2(d.getHours())}:${pad2(d.getMinutes())}`;
    }

    function getRateByHour(h){
      if (h <= 10) return { rate: 30, step: 1, label: "朝の早得" };
      if (h <= 16) return { rate: 20, step: 2, label: "昼の早得" };
      return { rate: 10, step: 3, label: "夕方の早得" };
    }

    function updateUI(){
      const now = new Date();
      const h = now.getHours();
      const info = getRateByHour(h);

      // 今日の有効期限（例：当日23:59）
      const deadline = new Date(now);
      deadline.setHours(23,59,0,0);

      // 表示
      document.getElementById("offText").innerHTML = `${info.rate}<span>% OFF</span>`;
      document.getElementById("deadlineText").textContent = `${pad2(deadline.getHours())}:${pad2(deadline.getMinutes())} まで`;
      document.getElementById("nowText").textContent = `現在 ${formatJP(now)}`;

      // ステップ強調
      for (const id of ["s1","s2","s3"]) document.getElementById(id).classList.remove("active");
      document.getElementById(`s${info.step}`).classList.add("active");

      // 状態ピル
      document.getElementById("statusPill").textContent = `本日は「${info.label}」`;

      // メーター：0:00〜24:00 の経過率
      const minutes = now.getHours()*60 + now.getMinutes();
      const pct = Math.max(0, Math.min(100, (minutes / (24*60)) * 100));
      document.getElementById("meterBar").style.width = `${pct.toFixed(1)}%`;
    }

    // サンプルボタン挙動
    document.getElementById("useBtn").addEventListener("click", () => {
      alert("（サンプル）クーポン利用処理をここに実装します。\n本番ではLIFFのユーザー情報や利用回数チェック等を入れます。");
    });

    document.getElementById("shareBtn").addEventListener("click", async () => {
      const url = location.href;
      const text = "早得クーポン（サンプル）\n早く使うほどお得！";
      try{
        if (navigator.share){
          await navigator.share({ title: "早得クーポン", text, url });
        } else {
          await navigator.clipboard.writeText(`${text}\n${url}`);
          alert("共有機能がないので、URLをコピーしました。");
        }
      }catch(e){
        // ユーザーがキャンセル等
      }
    });

    updateUI();
    // 1分ごと更新（見た目のライブ感）
    setInterval(updateUI, 60 * 1000);
  </script>
</body>
</html>
